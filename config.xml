<?xml version="1.0" encoding="utf-8"?>
<widget id="mk.clicaid.app" version="1.8"
  xmlns="http://www.w3.org/ns/widgets"
  xmlns:cdv="http://cordova.apache.org/ns/1.0">

  <name>Clicaid</name>
  <description>С нами Ваша жизнь будет в безопасности</description>
  <author email="info@clicaid.ru" href="https://clicaid.ru">Clicaid</author>

  <content src="index.html" />
  <access origin="*" />

  <allow-intent href="http://*/*" />
  <allow-intent href="https://*/*" />
  <allow-intent href="tel:*" />
  <allow-intent href="sms:*" />
  <allow-intent href="mailto:*" />
  <allow-intent href="geo:*" />

  <preference name="orientation" value="portrait" />
  <preference name="loadUrlTimeoutValue" value="50000" />

  <engine name="ios" spec="7.1.1" />
  <engine name="android" />
  <engine name="browser" />

  <!-- iOS -->
  <platform name="ios">
    <edit-config file="*-Info.plist" mode="merge" target="CFBundleDisplayName">
      <string>Clicaid Прозакон</string>
    </edit-config>
  </platform>

  <!-- ANDROID -->
  <platform name="android">
    <allow-intent href="market:*" />

    <icon density="ldpi"  src="ldpi.png" />
    <icon density="mdpi"  src="mdpi.png" />
    <icon density="hdpi"  src="hdpi.png" />
    <icon density="xhdpi" src="xhdpi.png" />
    <icon density="xxhdpi" src="xxhdpi.png" />
    <icon density="xxxhdpi" src="xxxhdpi.png" />

    <preference name="AndroidXEnabled" value="true" />
    <preference name="AndroidPersistentFileLocation" value="Compatibility" />
    <preference name="SplashScreenDelay" value="1000" />
    <preference name="AutoHideSplashScreen" value="true" />
    <preference name="FadeSplashScreen" value="true" />
    <preference name="FadeSplashScreenDuration" value="2000" />

    <!-- ВАЖНО: объявляем namespace tools прямо здесь -->
    <edit-config file="app/src/main/AndroidManifest.xml"
                 target="/manifest"
                 mode="merge">
      <manifest xmlns:tools="http://schemas.android.com/tools" />
    </edit-config>

    <!-- Удаляем дублирующиеся пермишены -->
<config-file parent="/manifest" target="AndroidManifest.xml" xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools">
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" tools:node="remove" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" tools:node="remove" />
</config-file>


    <!-- Android 12+: экспортируем MainActivity -->
    <edit-config file="app/src/main/AndroidManifest.xml"
                 target="/manifest/application/activity"
                 mode="merge"
                 xmlns:android="http://schemas.android.com/apk/res/android">
      <activity android:exported="true" />
    </edit-config>
  </platform>

  <plugin name="cordova-plugin-network-information" spec="^2.0.2" />
  <plugin name="cordova-plugin-geolocation" spec="^4.1.0">
    <variable name="GPS_REQUIRED" value="true" />
  </plugin>

  <preference name="android-minSdkVersion" value="24" />
  <preference name="android-targetSdkVersion" value="33" />
  <preference name="android-compileSdkVersion" value="33" />

</widget>
