<?xml version='1.0' encoding='utf-8'?>
<widget id="mk.clicaid.app" version="1.9.4"
        xmlns="http://www.w3.org/ns/widgets"
        xmlns:cdv="http://cordova.apache.org/ns/1.0">

    <name>Clicaid Prozakon</name>
    <description>С нами Ваша жизнь будет в безопасности</description>
    <author email="info@clicaid.ru" href="https://clicaid.ru">Clicaid</author>

    <content src="index.html" />

    <access origin="*" />
    <allow-intent href="http://*/*" />
    <allow-intent href="https://*/*" />
    <allow-intent href="tel:*" />
    <allow-intent href="sms:*" />
    <allow-intent href="mailto:*" />
    <allow-intent href="geo:*" />

    <preference name="orientation" value="portrait" />
    <preference name="loadUrlTimeoutValue" value="50000" />

    <!-- Платформы -->
    <engine name="android" spec="14.0.1" />
    <engine name="ios" spec="7.1.1" />
    <engine name="browser" />

    <!-- iOS -->
    <platform name="ios">
        <icon height="1024" src="icon-1024.png" width="1024" />
        <icon height="180" src="icon-60@3x.png" width="180" />
        <icon height="60" src="icon-60.png" width="60" />
        <icon height="120" src="icon-60@2x.png" width="120" />
        <icon height="76" src="icon-76.png" width="76" />
        <icon height="152" src="icon-76@2x.png" width="152" />
        <icon height="167" src="icon-83.5@2x.png" width="167" />
        <icon height="29" src="icon-small.png" width="29" />
        <icon height="58" src="icon-small@2x.png" width="58" />
        <icon height="87" src="icon-small@3x.png" width="87" />
        <icon height="40" src="icon-small-40.png" width="40" />
        <icon height="80" src="icon-small-40@2x.png" width="80" />
        <icon height="120" src="icon-small-40@3x.png" width="120" />

        <splash height="1136" src="Default-568h@2x.png" width="640" />
        <splash height="1334" src="Default-667h@2x.png" width="750" />
        <splash height="2208" src="Default-Portrait-736h@3x.png" width="1242" />
        <splash height="1024" src="Default-Portrait.png" width="768" />
        <splash height="2048" src="Default-Portrait@2x.png" width="1536" />
        <splash src="Default~iphone.png" />
        <splash src="Default@2x~iphone.png" />

        <edit-config file="*-Info.plist" mode="merge" target="CFBundleDisplayName">
            <string>Clicaid Прозакон</string>
        </edit-config>

        <edit-config file="*-Info.plist" mode="merge" target="NSLocationWhenInUseUsageDescription">
            <string>Приложению требуется доступ к вашей геолокации, чтобы показывать актуальную информацию и ближайшие объекты.</string>
        </edit-config>

        <edit-config file="*-Info.plist" mode="merge" target="NSLocationAlwaysAndWhenInUseUsageDescription">
            <string>Приложению требуется постоянный доступ к геолокации для работы в фоновом режиме и предоставления актуальной информации о ближайших объектах даже когда приложение не активно.</string>
        </edit-config>

        <!-- OneSignal iOS -->
        <config-file parent="OneSignal_APP_ID" target="*-Info.plist">
            <string>8c912104-8b46-497f-9ea2-d0cd76def931</string>
        </config-file>

        <config-file parent="OneSignal_notificationServiceExtension" target="*-Info.plist">
            <string>NotificationService</string>
        </config-file>

        <edit-config file="*-Info.plist" mode="merge" target="NSRemoteNotificationUsageDescription">
            <string>Для отправки уведомлений о важных событиях и обновлениях.</string>
        </edit-config>

        <config-file parent="UIBackgroundModes" target="*-Info.plist">
            <array>
                <string>remote-notification</string>
            </array>
        </config-file>

        <edit-config file="*-Info.plist" mode="merge" target="NSMicrophoneUsageDescription">
            <string>Для воспроизведения звука уведомлений</string>
        </edit-config>
    </platform>

    <!-- Android -->
    <platform name="android">
        <allow-intent href="market:*" />

        <icon density="ldpi" src="ldpi.png" />
        <icon density="mdpi" src="mdpi.png" />
        <icon density="hdpi" src="hdpi.png" />
        <icon density="xhdpi" src="xhdpi.png" />
        <icon density="xxhdpi" src="xxhdpi.png" />
        <icon density="xxxhdpi" src="xxxhdpi.png" />

        <preference name="AndroidXEnabled" value="true" />
        <preference name="AndroidPersistentFileLocation" value="Compatibility" />
        <preference name="SplashScreenDelay" value="1000" />
        <preference name="AutoHideSplashScreen" value="true" />
        <preference name="FadeSplashScreen" value="true" />
        <preference name="FadeSplashScreenDuration" value="2000" />

        <!-- android:exported для MainActivity -->
        <edit-config file="app/src/main/AndroidManifest.xml"
                     mode="merge"
                     target="/manifest/application/activity"
                     xmlns:android="http://schemas.android.com/apk/res/android">
            <activity android:exported="true" />
        </edit-config>

        <preference name="android-targetSdkVersion" value="34" />
    </platform>

    <!-- Плагины -->
    <plugin name="cordova-plugin-network-information" spec="^2.0.2" />
    <plugin name="cordova-plugin-geolocation" spec="^5.0.0">
        <variable name="GPS_REQUIRED" value="true" />
    </plugin>
    <plugin name="cordova-plugin-camera" spec="^7.0.0" />
    <plugin name="cordova-plugin-crop" spec="^0.4.0" />
    <plugin name="cordova-plugin-theme-detection" spec="^0.1.0" />
    <plugin name="cordova-plugin-android-permissions" spec="^1.1.5" />
    <plugin name="onesignal-cordova-plugin" spec="5.2.16" />

    <!-- Общие Android-префы -->
    <preference name="android-minSdkVersion" value="24" />
    <preference name="android-targetSdkVersion" value="35" />
    <preference name="android-compileSdkVersion" value="35" />

    <!-- OneSignal Android -->
    <preference name="onesignal-android-sender-id" value="897966400632" />
    <preference name="onesignal-autoRegister" value="true" />
    <preference name="onesignal-notification-opened-handler" value="true" />
</widget>
